/* ============================================================
   Blueprint for an AI-First Company - MkDocs Material Theme
   ============================================================
   Custom CSS mapping the blueprint design tokens to Material's
   CSS custom properties. Covers both dark (slate) and light
   (default) color schemes.
   ============================================================ */

/* ------------------------------------------------------------
   Design Tokens
   ------------------------------------------------------------ */
:root {
  /* Blueprint palette (dark defaults) */
  --bp-canvas: #0a0f1e;
  --bp-canvas-raised: #0f1529;
  --bp-canvas-surface: #141b33;
  --bp-grid: rgba(56, 189, 248, 0.04);
  --bp-grid-accent: rgba(56, 189, 248, 0.08);
  --bp-line: rgba(56, 189, 248, 0.12);
  --bp-line-strong: rgba(56, 189, 248, 0.25);
  --bp-cyan: #38bdf8;
  --bp-cyan-dim: rgba(56, 189, 248, 0.6);
  --bp-cyan-glow: rgba(56, 189, 248, 0.15);
  --bp-white: #f0f4ff;
  --bp-white-dim: rgba(240, 244, 255, 0.7);
  --bp-white-muted: rgba(240, 244, 255, 0.45);
  --bp-accent: #818cf8;
  --bp-accent-warm: #f59e0b;

  /* Typography stacks */
  --bp-serif: 'Instrument Serif', Georgia, serif;
  --bp-sans: 'Manrope', system-ui, sans-serif;
  --bp-mono: 'DM Mono', 'SF Mono', monospace;

  /* Animation */
  --bp-ease-out: cubic-bezier(0.16, 1, 0.3, 1);
}


/* ------------------------------------------------------------
   Dark Mode (slate scheme)
   ------------------------------------------------------------ */
[data-md-color-scheme="slate"] {
  /* Material core overrides */
  --md-default-bg-color: #0a0f1e;
  --md-default-fg-color: #f0f4ff;
  --md-default-fg-color--light: rgba(240, 244, 255, 0.7);
  --md-default-fg-color--lighter: rgba(240, 244, 255, 0.45);
  --md-default-fg-color--lightest: rgba(240, 244, 255, 0.2);

  --md-primary-fg-color: #38bdf8;
  --md-primary-fg-color--light: rgba(56, 189, 248, 0.6);
  --md-primary-fg-color--dark: #2196c4;
  --md-primary-bg-color: #0a0f1e;
  --md-primary-bg-color--light: #0f1529;

  --md-accent-fg-color: #818cf8;
  --md-accent-fg-color--transparent: rgba(129, 140, 248, 0.1);
  --md-accent-bg-color: #0a0f1e;

  /* Typography colors */
  --md-typeset-color: #f0f4ff;
  --md-typeset-a-color: #38bdf8;

  /* Code */
  --md-code-bg-color: #0f1529;
  --md-code-fg-color: #f0f4ff;
  --md-code-hl-color: rgba(56, 189, 248, 0.15);

  /* Footer */
  --md-footer-bg-color: #0a0f1e;
  --md-footer-bg-color--dark: #070b15;
  --md-footer-fg-color: rgba(240, 244, 255, 0.7);
  --md-footer-fg-color--light: rgba(240, 244, 255, 0.45);
  --md-footer-fg-color--lighter: rgba(240, 244, 255, 0.3);

  /* Blueprint tokens mapped */
  --bp-canvas: #0a0f1e;
  --bp-canvas-raised: #0f1529;
  --bp-canvas-surface: #141b33;
  --bp-grid: rgba(56, 189, 248, 0.04);
  --bp-grid-accent: rgba(56, 189, 248, 0.08);
  --bp-line: rgba(56, 189, 248, 0.12);
  --bp-line-strong: rgba(56, 189, 248, 0.25);
  --bp-cyan: #38bdf8;
  --bp-cyan-dim: rgba(56, 189, 248, 0.6);
  --bp-cyan-glow: rgba(56, 189, 248, 0.15);
  --bp-white: #f0f4ff;
  --bp-white-dim: rgba(240, 244, 255, 0.7);
  --bp-white-muted: rgba(240, 244, 255, 0.45);
  --bp-accent: #818cf8;
  --bp-accent-warm: #f59e0b;

  /* Mermaid diagram colors (dark mode) */
  --bp-mermaid-info-fill: #1e6fa5;
  --bp-mermaid-info-stroke: #155a85;
  --bp-mermaid-success-fill: #1a8a52;
  --bp-mermaid-success-stroke: #14693e;
  --bp-mermaid-warning-fill: #b87a0a;
  --bp-mermaid-warning-stroke: #946208;
  --bp-mermaid-danger-fill: #b52c2c;
  --bp-mermaid-danger-stroke: #921e1e;
  --bp-mermaid-purple-fill: #7345b0;
  --bp-mermaid-purple-stroke: #5b3590;
  --bp-mermaid-neutral-fill: #5a6878;
  --bp-mermaid-neutral-stroke: #47525f;
  --bp-mermaid-text: #fff;
  --bp-mermaid-subtitle-text: #fff;

  /* Match Mermaid's measurement font so text fits inside node boxes.
     Mermaid measures text width with this font during render, then
     Material's CSS replaces the display font. If they differ, text
     overflows. Using Mermaid's default font for both fixes this. */
  --md-mermaid-font-family: "trebuchet ms", verdana, arial, sans-serif;
}


/* ------------------------------------------------------------
   Light Mode (default scheme)
   ------------------------------------------------------------ */
[data-md-color-scheme="default"] {
  /* Material core overrides */
  --md-default-bg-color: #f5f3ef;
  --md-default-fg-color: #0f1529;
  --md-default-fg-color--light: rgba(15, 21, 41, 0.7);
  --md-default-fg-color--lighter: rgba(15, 21, 41, 0.45);
  --md-default-fg-color--lightest: rgba(15, 21, 41, 0.2);

  --md-primary-fg-color: #1d6fa5;
  --md-primary-fg-color--light: rgba(29, 111, 165, 0.6);
  --md-primary-fg-color--dark: #175a86;
  --md-primary-bg-color: #f5f3ef;
  --md-primary-bg-color--light: #edeae4;

  --md-accent-fg-color: #5b5fc7;
  --md-accent-fg-color--transparent: rgba(91, 95, 199, 0.1);
  --md-accent-bg-color: #f5f3ef;

  /* Typography colors */
  --md-typeset-color: #0f1529;
  --md-typeset-a-color: #1d6fa5;

  /* Code */
  --md-code-bg-color: #edeae4;
  --md-code-fg-color: #0f1529;
  --md-code-hl-color: rgba(29, 111, 165, 0.1);

  /* Footer */
  --md-footer-bg-color: #edeae4;
  --md-footer-bg-color--dark: #e5e2dc;
  --md-footer-fg-color: rgba(15, 21, 41, 0.7);
  --md-footer-fg-color--light: rgba(15, 21, 41, 0.45);
  --md-footer-fg-color--lighter: rgba(15, 21, 41, 0.3);

  /* Blueprint tokens mapped */
  --bp-canvas: #f5f3ef;
  --bp-canvas-raised: #edeae4;
  --bp-canvas-surface: #e5e2dc;
  --bp-grid: rgba(15, 21, 41, 0.06);
  --bp-grid-accent: rgba(15, 21, 41, 0.10);
  --bp-line: rgba(15, 21, 41, 0.1);
  --bp-line-strong: rgba(15, 21, 41, 0.2);
  --bp-cyan: #1d6fa5;
  --bp-cyan-dim: rgba(29, 111, 165, 0.6);
  --bp-cyan-glow: rgba(29, 111, 165, 0.08);
  --bp-white: #0f1529;
  --bp-white-dim: rgba(15, 21, 41, 0.7);
  --bp-white-muted: rgba(15, 21, 41, 0.45);
  --bp-accent: #5b5fc7;
  --bp-accent-warm: #c77d0a;

  /* Mermaid diagram colors (light mode) */
  --bp-mermaid-info-fill: #d4e8f5;
  --bp-mermaid-info-stroke: #a8c8de;
  --bp-mermaid-success-fill: #d2eddf;
  --bp-mermaid-success-stroke: #a4d4bb;
  --bp-mermaid-warning-fill: #f5e6cc;
  --bp-mermaid-warning-stroke: #e0c89a;
  --bp-mermaid-danger-fill: #f5d4d4;
  --bp-mermaid-danger-stroke: #dea8a8;
  --bp-mermaid-purple-fill: #e4d8f2;
  --bp-mermaid-purple-stroke: #c4ade0;
  --bp-mermaid-neutral-fill: #e2e4e8;
  --bp-mermaid-neutral-stroke: #c5c9d0;
  --bp-mermaid-text: #1a2030;
  --bp-mermaid-subtitle-text: #4a5260;

  /* Match Mermaid's measurement font (same reason as dark mode above). */
  --md-mermaid-font-family: "trebuchet ms", verdana, arial, sans-serif;
}


/* ------------------------------------------------------------
   Typography
   ------------------------------------------------------------ */

/* Body text - Manrope */
:root {
  --md-text-font: "Manrope";
  --md-code-font: "DM Mono";
}

body,
.md-typeset {
  font-family: var(--bp-sans);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Headings - Instrument Serif */
.md-typeset h1,
.md-typeset h2,
.md-typeset h3,
.md-typeset h4,
.md-typeset h5,
.md-typeset h6 {
  font-family: var(--bp-serif);
  font-weight: 400;
  letter-spacing: -0.01em;
}

.md-typeset h1 {
  font-size: 2.4rem;
  line-height: 1.1;
  letter-spacing: -0.02em;
}

.md-typeset h2 {
  font-size: 1.8rem;
  line-height: 1.2;
}

.md-typeset h3 {
  font-size: 1.4rem;
  line-height: 1.25;
  color: var(--bp-cyan);
}

.md-typeset h4 {
  font-size: 1.15rem;
  line-height: 1.3;
}

/* Code - DM Mono */
.md-typeset code,
.md-typeset pre,
.md-typeset kbd {
  font-family: var(--bp-mono);
}


/* ------------------------------------------------------------
   Blueprint Grid Background
   ------------------------------------------------------------ */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background:
    linear-gradient(var(--bp-grid) 1px, transparent 1px),
    linear-gradient(90deg, var(--bp-grid) 1px, transparent 1px),
    linear-gradient(var(--bp-grid-accent) 1px, transparent 1px),
    linear-gradient(90deg, var(--bp-grid-accent) 1px, transparent 1px);
  background-size:
    20px 20px,
    20px 20px,
    100px 100px,
    100px 100px;
  z-index: 0;
  pointer-events: none;
  opacity: 0.6;
}

/* Light mode: subtle grid for clean reading */
body[data-md-color-scheme="default"]::before {
  opacity: 0.15;
}

/* Ensure all content layers above the grid */
.md-header,
.md-container,
.md-footer,
.md-dialog,
.md-top,
.md-search {
  position: relative;
  z-index: 1;
}


/* ------------------------------------------------------------
   Header
   ------------------------------------------------------------ */
.md-header {
  background: color-mix(in srgb, var(--bp-canvas) 85%, transparent);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--bp-line);
  box-shadow: none;
  z-index: 4;
}

.md-header[data-md-state="shadow"] {
  box-shadow: none;
  border-bottom: 1px solid var(--bp-line-strong);
}

/* Dark mode: bump opacity + fix text/icon visibility.
   Material uses --md-primary-bg-color as text color inside
   header/tabs. We override it in scope so all children
   (icons, tabs, buttons, source link) inherit correctly. */
[data-md-color-scheme="slate"] .md-header {
  background: color-mix(in srgb, var(--bp-canvas) 92%, transparent);
  --md-primary-bg-color: var(--bp-white);
  color: var(--bp-white);
}

[data-md-color-scheme="slate"] .md-tabs {
  background: color-mix(in srgb, var(--bp-canvas) 92%, transparent);
  --md-primary-bg-color: var(--bp-white);
  color: var(--bp-white);
}

[data-md-color-scheme="slate"] .md-tabs__link {
  color: var(--bp-white-dim) !important;
  opacity: 0.7;
}

/* Header title */
.md-header__title {
  font-family: var(--bp-mono);
  font-size: 0.8rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
}

/* Header topic (project name) */
.md-header__topic:first-child {
  font-family: var(--bp-mono);
  letter-spacing: 0.08em;
  color: var(--bp-cyan);
}

/* Tabs */
.md-tabs {
  background: color-mix(in srgb, var(--bp-canvas) 90%, transparent);
  border-bottom: 1px solid var(--bp-line);
}

.md-tabs__link {
  font-family: var(--bp-mono);
  font-size: 0.72rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  opacity: 0.6;
  transition: opacity 0.3s, color 0.3s;
}

.md-tabs__link:hover,
.md-tabs__link--active {
  opacity: 1;
  color: var(--bp-cyan);
}

/* Light mode: white backgrounds with shadow elevation */
[data-md-color-scheme="default"] .md-header {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--bp-line-strong);
  box-shadow: 0 1px 3px rgba(15, 21, 41, 0.06);
  --md-primary-bg-color: var(--bp-white);
  color: var(--bp-white);
}

[data-md-color-scheme="default"] .md-header[data-md-state="shadow"] {
  box-shadow: 0 2px 8px rgba(15, 21, 41, 0.08);
}

[data-md-color-scheme="default"] .md-tabs {
  background: rgba(255, 255, 255, 0.9);
  border-bottom: 1px solid var(--bp-line-strong);
  --md-primary-bg-color: var(--bp-white);
  color: var(--bp-white);
}

[data-md-color-scheme="default"] .md-tabs__link {
  opacity: 1;
  color: var(--bp-white-dim);
}

[data-md-color-scheme="default"] .md-tabs__link:hover,
[data-md-color-scheme="default"] .md-tabs__link--active {
  color: var(--bp-cyan);
}

[data-md-color-scheme="default"] .md-search__form {
  background-color: var(--bp-canvas) !important;
  border: 1px solid var(--bp-line-strong) !important;
  border-radius: 4px !important;
}


/* ------------------------------------------------------------
   Sidebar Navigation
   ------------------------------------------------------------ */
.md-sidebar {
  background: transparent;
}

.md-nav__title {
  font-family: var(--bp-mono);
  font-size: 0.7rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--bp-cyan);
}

.md-nav__link {
  font-family: var(--bp-sans);
  font-size: 0.82rem;
  color: var(--bp-white-dim);
  transition: color 0.2s;
}

.md-nav__link:hover {
  color: var(--bp-cyan);
}

.md-nav__link--active {
  color: var(--bp-cyan);
  font-weight: 600;
}

/* Sidebar item border accent */
.md-nav__item--active > .md-nav__link {
  border-left: 2px solid var(--bp-cyan);
  padding-left: 0.6rem;
}

/* Nested nav sections */
.md-nav--secondary .md-nav__title {
  font-size: 0.65rem;
  color: var(--bp-white-muted);
}


/* ------------------------------------------------------------
   Content Area
   ------------------------------------------------------------ */
.md-content {
  background: transparent;
}

/* Links */
.md-typeset a {
  color: var(--bp-cyan);
  text-decoration: none;
  border-bottom: 1px solid transparent;
  transition: border-color 0.3s;
}

.md-typeset a:hover {
  border-bottom-color: var(--bp-cyan);
}

/* Horizontal rules */
.md-typeset hr {
  border-color: var(--bp-line);
}

/* Tables */
.md-typeset table:not([class]) {
  border: 1px solid var(--bp-line);
  font-size: 0.85rem;
}

.md-typeset table:not([class]) th {
  background: var(--bp-canvas-raised);
  font-family: var(--bp-mono);
  font-size: 0.75rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--bp-cyan);
  border-bottom: 1px solid var(--bp-line-strong);
}

.md-typeset table:not([class]) td {
  border-bottom: 1px solid var(--bp-line);
}

.md-typeset table:not([class]) tr:hover td {
  background: var(--bp-canvas-raised);
}


/* ------------------------------------------------------------
   Code Blocks
   ------------------------------------------------------------ */
.md-typeset pre {
  border: 1px solid var(--bp-line);
  border-radius: 6px;
  background: var(--bp-canvas-raised);
}

.md-typeset pre > code {
  font-family: var(--bp-mono);
  font-size: 0.85em;
  line-height: 1.6;
}

/* Inline code */
.md-typeset code:not(pre code) {
  font-family: var(--bp-mono);
  font-size: 0.85em;
  padding: 0.15em 0.4em;
  border-radius: 4px;
  background: var(--bp-canvas-raised);
  border: 1px solid var(--bp-line);
  color: var(--bp-cyan);
}

/* Code copy button */
.md-clipboard {
  color: var(--bp-white-muted);
}

.md-clipboard:hover {
  color: var(--bp-cyan);
}

/* Code annotations */
.md-typeset .md-annotation__index {
  background: var(--bp-cyan);
  color: var(--bp-canvas);
}


/* ------------------------------------------------------------
   Admonitions
   ------------------------------------------------------------ */
.md-typeset .admonition,
.md-typeset details {
  border: 1px solid var(--bp-line);
  border-left: 4px solid var(--bp-cyan);
  border-radius: 6px;
  background: var(--bp-canvas-raised);
  box-shadow: none;
}

.md-typeset .admonition-title,
.md-typeset details > summary {
  background: var(--bp-canvas-surface);
  border-bottom: 1px solid var(--bp-line);
  font-family: var(--bp-sans);
  font-weight: 600;
}

/* Info / Note admonitions */
.md-typeset .admonition.note,
.md-typeset .admonition.info {
  border-left-color: var(--bp-cyan);
}

/* Warning admonitions */
.md-typeset .admonition.warning,
.md-typeset .admonition.caution {
  border-left-color: var(--bp-accent-warm);
}

/* Tip admonitions */
.md-typeset .admonition.tip,
.md-typeset .admonition.hint {
  border-left-color: var(--bp-accent);
}

/* Example admonitions */
.md-typeset .admonition.example {
  border-left-color: var(--bp-accent);
}


/* ------------------------------------------------------------
   Search
   ------------------------------------------------------------ */

/* Ensure search sits above everything */
.md-search {
  z-index: 10;
}

/* Full-page backdrop overlay when search is open */
.md-search__overlay {
  background: rgba(0, 0, 0, 0.54);
  opacity: 0;
  transition: opacity 0.25s;
}

[data-md-toggle="search"]:checked ~ .md-header .md-search__overlay {
  opacity: 1;
}

/* Search form container */
.md-search__form {
  background-color: var(--bp-canvas-raised) !important;
  transition: none !important;
}

.md-search__input {
  font-family: var(--bp-sans);
  color: var(--bp-white);
  transition: none !important;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.md-search__input::placeholder {
  color: var(--bp-white-muted);
}

/* Hide autocomplete suggestion hint */
.md-search__suggest {
  display: none !important;
}

/* Search inner - no shadow in default state; shadow only when results show */
.md-search__inner {
  box-shadow: none;
}

[data-md-toggle="search"]:checked ~ .md-header .md-search__inner {
  background: var(--bp-canvas);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

/* Search output / results container */
.md-search__output {
  background: var(--bp-canvas);
  border-top: 1px solid var(--bp-line);
}

.md-search__scrollwrap {
  background: var(--bp-canvas);
}

/* Search results */
.md-search-result {
  background: var(--bp-canvas);
}

.md-search-result__meta {
  background: var(--bp-canvas-raised);
  font-family: var(--bp-mono);
  font-size: 0.7rem;
  letter-spacing: 0.06em;
  color: var(--bp-white-muted);
}

.md-search-result__item {
  border-bottom: 1px solid var(--bp-line);
}

.md-search-result__link {
  background: var(--bp-canvas);
}

.md-search-result__link:hover {
  background: var(--bp-canvas-raised);
}

.md-search-result__article h1 {
  font-family: var(--bp-serif);
  color: var(--bp-white);
}

.md-search-result__teaser {
  color: var(--bp-white-dim);
}

.md-search-result mark {
  background: var(--bp-cyan-glow);
  color: var(--bp-cyan);
}

/* Search result list */
.md-search-result__list {
  background: var(--bp-canvas);
}

/* Light mode: white search backgrounds */
[data-md-color-scheme="default"] [data-md-toggle="search"]:checked ~ .md-header .md-search__inner {
  background: #ffffff;
}

[data-md-color-scheme="default"] .md-search__output {
  background: #ffffff;
}

[data-md-color-scheme="default"] .md-search__scrollwrap {
  background: #ffffff;
}

[data-md-color-scheme="default"] .md-search-result {
  background: #ffffff;
}

[data-md-color-scheme="default"] .md-search-result__link {
  background: #ffffff;
}

[data-md-color-scheme="default"] .md-search-result__link:hover {
  background: var(--bp-canvas);
}

[data-md-color-scheme="default"] .md-search-result__meta {
  background: var(--bp-canvas);
}


/* ------------------------------------------------------------
   Footer
   ------------------------------------------------------------ */
.md-footer {
  background: var(--bp-canvas);
  border-top: 1px solid var(--bp-line);
}

.md-footer-meta {
  background: var(--bp-canvas);
}

/* Light mode: footer contrast */
[data-md-color-scheme="default"] .md-footer {
  background: rgba(255, 255, 255, 0.8);
  border-top: 1px solid var(--bp-line-strong);
}

[data-md-color-scheme="default"] .md-footer-meta {
  background: transparent;
}

.md-footer-nav__link {
  font-family: var(--bp-mono);
  font-size: 0.8rem;
  transition: color 0.3s;
}

.md-footer-nav__link:hover {
  color: var(--bp-cyan);
}

.md-footer-nav__direction {
  font-family: var(--bp-mono);
  font-size: 0.65rem;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: var(--bp-white-muted);
}

.md-footer__link {
  transition: opacity 0.3s;
}

.md-footer__link:hover {
  opacity: 1;
}

/* Copyright */
.md-copyright {
  font-family: var(--bp-mono);
  font-size: 0.7rem;
  letter-spacing: 0.04em;
  color: var(--bp-white-muted);
}


/* ------------------------------------------------------------
   Table of Contents (right sidebar)
   ------------------------------------------------------------ */
.md-sidebar--secondary .md-nav__link {
  font-size: 0.78rem;
  color: var(--bp-white-muted);
}

.md-sidebar--secondary .md-nav__link:hover {
  color: var(--bp-cyan);
}

.md-sidebar--secondary .md-nav__link--active {
  color: var(--bp-cyan);
}


/* ------------------------------------------------------------
   Scroll-to-top Button
   ------------------------------------------------------------ */
.md-top {
  background: var(--bp-canvas-raised);
  border: 1px solid var(--bp-line);
  color: var(--bp-cyan);
  font-family: var(--bp-mono);
  font-size: 0.7rem;
}

.md-top:hover {
  background: var(--bp-canvas-surface);
  border-color: var(--bp-cyan);
}


/* ------------------------------------------------------------
   Palette Toggle
   ------------------------------------------------------------ */
[data-md-component="palette"] button {
  transition: color 0.3s;
}


/* ------------------------------------------------------------
   Tabbed Content (pymdownx.tabbed)
   ------------------------------------------------------------ */
.md-typeset .tabbed-labels > label {
  font-family: var(--bp-mono);
  font-size: 0.78rem;
  letter-spacing: 0.04em;
  color: var(--bp-white-muted);
}

.md-typeset .tabbed-labels > label:hover {
  color: var(--bp-cyan);
}

.md-typeset .tabbed-labels > .tabbed-labels__active,
.md-typeset .tabbed-labels > label.tabbed-labels__active {
  color: var(--bp-cyan);
}

.md-typeset .tabbed-set .tabbed-content {
  border: 1px solid var(--bp-line);
  border-top: none;
  border-radius: 0 0 6px 6px;
}


/* ------------------------------------------------------------
   Task Lists (pymdownx.tasklist)
   ------------------------------------------------------------ */
.md-typeset .task-list-indicator::before {
  border-color: var(--bp-line-strong);
}

.md-typeset [type="checkbox"]:checked + .task-list-indicator::before {
  background: var(--bp-cyan);
  border-color: var(--bp-cyan);
}


/* ------------------------------------------------------------
   Footnotes
   ------------------------------------------------------------ */
.md-typeset .footnote-ref {
  color: var(--bp-cyan);
  font-family: var(--bp-mono);
  font-size: 0.75em;
}

.md-typeset .footnote {
  font-size: 0.85rem;
  color: var(--bp-white-dim);
}

.md-typeset .footnote ol {
  border-top: 1px solid var(--bp-line);
  padding-top: 1rem;
}


/* ------------------------------------------------------------
   Yirifi Anchor – "From the Trenches" callout
   ------------------------------------------------------------ */
.yirifi-anchor {
  position: relative;
  margin: 2.5rem 0;
  padding: 1rem 1.25rem 1rem 1.5rem;
  background: rgba(245, 158, 11, 0.03);
  border: 1px solid rgba(245, 158, 11, 0.12);
  border-left: 3px solid var(--bp-accent-warm);
  border-radius: 0 4px 4px 0;
}

.yirifi-anchor::before {
  content: 'Yirifi Anchor — From the Trenches';
  display: block;
  font-family: var(--bp-mono);
  font-size: 0.75rem;
  font-weight: 700;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: var(--bp-accent-warm);
  margin-bottom: 0.6rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid rgba(245, 158, 11, 0.1);
}

.md-typeset .yirifi-anchor blockquote {
  border-left: none;
  background: none;
  border-radius: 0;
  margin: 0 0 0.6rem 0;
  padding: 0;
  font-family: 'Cormorant Garamond', Georgia, serif;
  font-weight: 500;
  font-style: italic;
  font-size: 1.2em;
  line-height: 1.6;
  color: rgba(240, 244, 255, 0.88);
}

.md-typeset .yirifi-anchor blockquote p {
  margin: 0;
}

.yirifi-anchor > p {
  font-size: 0.88rem;
  line-height: 1.55;
  margin: 0 0 0.3rem 0;
  color: var(--bp-white-dim);
}

.yirifi-anchor > :last-child {
  margin-bottom: 0;
}

/* Light mode */
[data-md-color-scheme="default"] .yirifi-anchor {
  background: rgba(245, 158, 11, 0.04);
  border-color: rgba(197, 125, 10, 0.15);
  border-left-color: var(--bp-accent-warm);
}

[data-md-color-scheme="default"] .yirifi-anchor::before {
  border-bottom-color: rgba(197, 125, 10, 0.12);
}

[data-md-color-scheme="default"] .md-typeset .yirifi-anchor blockquote {
  background: none;
  color: rgba(15, 21, 41, 0.8);
}

[data-md-color-scheme="default"] .yirifi-anchor > p {
  color: rgba(15, 21, 41, 0.72);
}


/* ------------------------------------------------------------
   Smooth Transitions
   ------------------------------------------------------------ */
body,
.md-header,
.md-tabs,
.md-sidebar,
.md-content,
.md-footer {
  transition:
    background 0.4s var(--bp-ease-out),
    color 0.4s var(--bp-ease-out),
    border-color 0.4s var(--bp-ease-out);
}


/* ------------------------------------------------------------
   Mermaid Diagram Theming
   ------------------------------------------------------------ */

/* Container: give diagrams a raised card treatment.
   Mermaid.js replaces <pre class="mermaid"> with <div class="mermaid">
   at runtime, so we target both. */
.md-typeset pre.mermaid,
.md-typeset > div.mermaid,
.md-typeset > .mermaid {
  background: var(--bp-canvas-raised);
  border: 1px solid var(--bp-line);
  border-radius: 6px;
  padding: 1.5rem 1rem;
  text-align: center;
  overflow-x: auto;
}

/* Node text: Material 9.x renders Mermaid inside a shadow DOM.
   External CSS cannot penetrate the shadow boundary, so text
   color/font overrides must be done via the JS post-processor
   in main.html (which accesses the open shadow root) or via
   CSS custom properties that inherit into the shadow DOM. */

/* Edge (arrow) paths */
.mermaid .edgePath .path,
.mermaid .flowchart-link {
  stroke: var(--bp-line-strong) !important;
  stroke-width: 1.5px;
}

/* Arrowheads */
.mermaid marker path {
  fill: var(--bp-line-strong) !important;
}

/* Edge labels (text on arrows like "107x cheaper") */
.mermaid .edgeLabel {
  font-family: var(--bp-mono) !important;
  font-size: 0.72rem !important;
  background: var(--bp-canvas-raised) !important;
  color: var(--bp-white-dim) !important;
}

.mermaid .edgeLabel .label {
  color: var(--bp-white-dim) !important;
}

.mermaid .edgeLabel rect {
  fill: var(--bp-canvas-raised) !important;
  stroke: none !important;
  opacity: 0.9;
}

/* Subgraph containers */
.mermaid .cluster rect {
  fill: var(--bp-canvas-surface) !important;
  stroke: var(--bp-line) !important;
  stroke-width: 1px;
  rx: 6px;
  ry: 6px;
}

/* Subgraph titles */
.mermaid .cluster .nodeLabel,
.mermaid .cluster-label .nodeLabel {
  font-family: var(--bp-mono) !important;
  font-size: 0.7rem !important;
  letter-spacing: 0.06em;
  fill: var(--bp-cyan) !important;
  color: var(--bp-cyan) !important;
}

/* Default node fill (nodes without inline style overrides) */
.mermaid .node rect,
.mermaid .node circle,
.mermaid .node polygon {
  stroke: var(--bp-line-strong) !important;
  stroke-width: 1px;
}

/* Rounded stadium nodes (the ([...]) syntax) */
.mermaid .node .label-container {
  stroke: var(--bp-line-strong) !important;
}

/* Light mode overrides */
[data-md-color-scheme="default"] .md-typeset pre.mermaid,
[data-md-color-scheme="default"] .md-typeset > div.mermaid,
[data-md-color-scheme="default"] .md-typeset > .mermaid {
  background: rgba(15, 21, 41, 0.03);
  border-color: rgba(15, 21, 41, 0.1);
}

[data-md-color-scheme="default"] .mermaid .edgePath .path,
[data-md-color-scheme="default"] .mermaid .flowchart-link {
  stroke: rgba(15, 21, 41, 0.35) !important;
}

[data-md-color-scheme="default"] .mermaid marker path {
  fill: rgba(15, 21, 41, 0.35) !important;
}

[data-md-color-scheme="default"] .mermaid .edgeLabel {
  background: rgba(15, 21, 41, 0.03) !important;
  color: rgba(15, 21, 41, 0.6) !important;
}

[data-md-color-scheme="default"] .mermaid .edgeLabel .label {
  color: rgba(15, 21, 41, 0.6) !important;
}

[data-md-color-scheme="default"] .mermaid .edgeLabel rect {
  fill: rgba(15, 21, 41, 0.03) !important;
}

[data-md-color-scheme="default"] .mermaid .cluster rect {
  fill: rgba(15, 21, 41, 0.04) !important;
  stroke: rgba(15, 21, 41, 0.12) !important;
}

[data-md-color-scheme="default"] .mermaid .cluster .nodeLabel,
[data-md-color-scheme="default"] .mermaid .cluster-label .nodeLabel {
  color: var(--bp-cyan) !important;
}


/* ------------------------------------------------------------
   Blockquotes (standalone, outside yirifi-anchor)
   ------------------------------------------------------------ */
.md-typeset blockquote {
  border-left: 3px solid var(--bp-cyan);
  background: rgba(56, 189, 248, 0.04);
  border-radius: 0 6px 6px 0;
  margin: 2rem 0;
  padding: 0.75rem 1rem;
  font-family: 'Cormorant Garamond', Georgia, serif;
  font-weight: 500;
  font-style: italic;
  font-size: 1.4em;
  line-height: 1.7;
  color: #5edbff;
}

.md-typeset blockquote p {
  margin: 0;
}

.md-typeset blockquote p + p {
  margin-top: 0.75rem;
}

/* Light mode */
[data-md-color-scheme="default"] .md-typeset blockquote {
  border-left-color: var(--bp-cyan);
  background: rgba(29, 111, 165, 0.05);
  color: #124d73;
}


/* ------------------------------------------------------------
   Horizontal Rules — Book-grade section dividers
   ------------------------------------------------------------ */
.md-typeset hr {
  border: none;
  height: 1px;
  background: linear-gradient(
    90deg,
    transparent,
    var(--bp-line-strong) 20%,
    var(--bp-line-strong) 80%,
    transparent
  );
  margin: 2.5rem 0;
  opacity: 0.7;
}


/* ------------------------------------------------------------
   Yirifi Anchor — Semantic labels (insight / close)
   ------------------------------------------------------------ */

/* Style **Label:** bold text inside yirifi anchors as inline amber tags */
.yirifi-anchor > p > strong:first-child {
  font-family: var(--bp-mono);
  font-size: 0.72rem;
  font-weight: 500;
  letter-spacing: 0.04em;
  color: var(--bp-accent-warm);
}


/* ------------------------------------------------------------
   Chapter Navigation Footer
   Bottom breadcrumb: [Part Overview](...) | [Book Contents](...)
   ------------------------------------------------------------ */
.md-typeset hr + p:last-child a {
  font-family: var(--bp-mono);
  font-size: 0.72rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--bp-white-muted);
  border-bottom: 1px solid transparent;
  transition: color 0.3s, border-color 0.3s;
}

.md-typeset hr + p:last-child a:hover {
  color: var(--bp-cyan);
  border-bottom-color: var(--bp-cyan);
}

.md-typeset hr + p:last-child {
  text-align: center;
  color: var(--bp-white-muted);
  font-family: var(--bp-mono);
  font-size: 0.72rem;
  letter-spacing: 0.06em;
  margin-top: -0.5rem;
  padding-top: 1rem;
}

/* ------------------------------------------------------------
   Sidebar Toggle (collapse / expand)
   Keyboard: [ = toggle left, ] = toggle right
   ------------------------------------------------------------ */

/* Toggle pill — high-contrast, positioned at viewport edge */
.bp-sidebar-toggle {
  position: fixed;
  top: 50%;
  transform: translateY(-50%);
  z-index: 10;
  width: 14px;
  height: 72px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #00e5ff;
  border: none;
  color: #000;
  cursor: pointer;
  opacity: 0.85;
  box-shadow: 0 0 12px rgba(0, 229, 255, 0.6);
  transition: opacity 0.25s, width 0.2s;
  padding: 0;
}

.bp-sidebar-toggle:hover {
  opacity: 1;
  width: 18px;
  box-shadow: 0 0 20px rgba(0, 229, 255, 0.9);
}

.bp-sidebar-toggle svg {
  width: 10px;
  height: 10px;
  transition: transform 0.3s var(--bp-ease-out);
}

.bp-toggle-left {
  left: 0;
  border-radius: 0 6px 6px 0;
}

.bp-toggle-right {
  right: 0;
  border-radius: 6px 0 0 6px;
}

/* Sidebar transitions */
.md-sidebar--primary {
  transition: transform 0.35s var(--bp-ease-out), opacity 0.35s var(--bp-ease-out);
}

.md-sidebar--secondary {
  transition: transform 0.35s var(--bp-ease-out), opacity 0.35s var(--bp-ease-out);
}

/* Collapsed states */
body.bp-left-collapsed .md-sidebar--primary {
  transform: translateX(-100%);
  opacity: 0;
  pointer-events: none;
}

body.bp-right-collapsed .md-sidebar--secondary {
  transform: translateX(100%);
  opacity: 0;
  pointer-events: none;
}

/* Flip arrow when collapsed */
body.bp-left-collapsed .bp-toggle-left svg {
  transform: rotate(180deg);
}

body.bp-right-collapsed .bp-toggle-right svg {
  transform: rotate(180deg);
}

/* Expand content when sidebars hidden */
@media screen and (min-width: 60em) {
  body.bp-left-collapsed .md-sidebar--primary {
    width: 0;
    overflow: hidden;
  }

  body.bp-right-collapsed .md-sidebar--secondary {
    width: 0;
    overflow: hidden;
  }
}

/* Hide toggles on mobile (sidebars already overlay) */
@media screen and (max-width: 59.9375em) {
  .bp-sidebar-toggle {
    display: none;
  }
}

/* Light mode — dark contrasting pill */
[data-md-color-scheme="default"] .bp-sidebar-toggle {
  background: #0f1529;
  color: #ffffff;
  box-shadow: 0 0 8px rgba(15, 21, 41, 0.3);
}

[data-md-color-scheme="default"] .bp-sidebar-toggle:hover {
  box-shadow: 0 0 16px rgba(15, 21, 41, 0.5);
}


/* ============================================================
   Engagement Components: Share, CTA, Comments, Social Proof
   ============================================================ */

/* ---- Share Buttons ---- */
.bp-share {
  margin-top: 3rem;
  padding-top: 2rem;
  border-top: 1px solid var(--bp-line);
  display: flex;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.bp-share-label {
  font-family: var(--bp-mono);
  font-size: 0.72rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--bp-white-muted);
}

.bp-share-links {
  display: flex;
  gap: 0.75rem;
  flex-wrap: wrap;
}

.bp-share-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.8rem;
  font-family: var(--bp-mono);
  font-size: 0.72rem;
  letter-spacing: 0.04em;
  color: var(--bp-white-muted);
  border: 1px solid var(--bp-line);
  border-radius: 4px;
  text-decoration: none;
  transition: all 0.3s var(--bp-ease);
}

.bp-share-btn:hover {
  border-color: var(--bp-cyan);
  color: var(--bp-cyan);
  transform: translateY(-1px);
}

.bp-share-btn svg {
  flex-shrink: 0;
}

/* ---- CTA Banner ---- */
.bp-cta-banner {
  margin: 2.5rem 0 2rem;
  padding: 1.5rem;
  border: 1px solid var(--bp-line);
  border-radius: 6px;
  background: var(--bp-canvas-raised);
  text-align: center;
}

.bp-cta-label {
  font-family: var(--bp-mono);
  font-size: 0.72rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--bp-cyan);
  display: block;
  margin-bottom: 1rem;
}

.bp-cta-actions {
  display: flex;
  justify-content: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.bp-cta-action {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.5rem 1rem;
  font-family: var(--bp-mono);
  font-size: 0.72rem;
  letter-spacing: 0.04em;
  color: var(--bp-white-dim);
  border: 1px solid var(--bp-line);
  border-radius: 4px;
  text-decoration: none;
  transition: all 0.3s var(--bp-ease);
}

.bp-cta-action:hover {
  border-color: var(--bp-cyan);
  color: var(--bp-cyan);
  transform: translateY(-1px);
}

.bp-cta-action svg {
  flex-shrink: 0;
}

/* ---- Giscus Comments ---- */
.giscus {
  margin-top: 1rem;
}

.giscus-frame {
  border: 1px solid var(--bp-line) !important;
  border-radius: 6px;
}

/* ---- Home Page: Social Proof Strip ---- */
.bp-social-proof {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1.5rem;
  margin-top: 1.5rem;
  margin-bottom: 0.5rem;
}

.bp-proof-item {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  font-family: var(--bp-mono);
  font-size: 0.72rem;
  letter-spacing: 0.04em;
  color: var(--bp-white-muted);
  text-decoration: none;
  transition: color 0.3s var(--bp-ease);
}

a.bp-proof-item:hover {
  color: var(--bp-cyan);
}

.bp-proof-item svg {
  flex-shrink: 0;
  opacity: 0.7;
}

a.bp-proof-item:hover svg {
  opacity: 1;
}

/* ---- Light Mode Overrides for Engagement Components ---- */
[data-md-color-scheme="default"] .bp-share-btn {
  color: #5a6270;
  border-color: rgba(15, 21, 41, 0.12);
}

[data-md-color-scheme="default"] .bp-share-btn:hover {
  color: var(--bp-cyan);
  border-color: var(--bp-cyan);
}

[data-md-color-scheme="default"] .bp-share-label {
  color: #5a6270;
}

[data-md-color-scheme="default"] .bp-cta-banner {
  background: rgba(15, 21, 41, 0.03);
  border-color: rgba(15, 21, 41, 0.12);
}

[data-md-color-scheme="default"] .bp-cta-action {
  color: #3a4250;
  border-color: rgba(15, 21, 41, 0.15);
}

[data-md-color-scheme="default"] .bp-cta-action:hover {
  color: var(--bp-cyan);
  border-color: var(--bp-cyan);
}

[data-md-color-scheme="default"] .bp-proof-item {
  color: #5a6270;
}

[data-md-color-scheme="default"] a.bp-proof-item:hover {
  color: var(--bp-cyan);
}

[data-md-color-scheme="default"] .giscus-frame {
  border-color: rgba(15, 21, 41, 0.12) !important;
}

/* ---- Responsive: Engagement Components ---- */
@media (max-width: 768px) {
  .bp-share {
    flex-direction: column;
    align-items: flex-start;
  }

  .bp-cta-actions {
    flex-direction: column;
    align-items: stretch;
  }

  .bp-cta-action {
    justify-content: center;
  }

  .bp-social-proof {
    gap: 1rem;
    flex-wrap: wrap;
  }
}

@media (max-width: 480px) {
  .bp-share-links {
    flex-direction: column;
    width: 100%;
  }

  .bp-share-btn {
    justify-content: center;
  }
}
